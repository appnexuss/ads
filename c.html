<script type="text/javascript">
//用于创建XMLHttpRequest对象
function createXmlHttp() {
 //根据window.XMLHttpRequest对象是否存在使用不同的创建方式
    if (window.XMLHttpRequest) {
       xmlHttp = new XMLHttpRequest();                  //FireFox、Opera等浏览器支持的创建方式
    } else {
       xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");//IE浏览器支持的创建方式
    }
}
//直接通过XMLHttpRequest对象获取远程网页源代码
function getSource() {
    var url = document.getElementById("url").value;             //获取目标地址信
    createXmlHttp();                                            //创建XMLHttpRequest对象
    xmlHttp.onreadystatechange = writeSource;                   //设置回调函数
    xmlHttp.open("GET", url, true);
    xmlHttp.send(null);
}
//将远程网页源代码写入页面文字区域
function writeSource() {
    if (xmlHttp.readyState == 4) {
        var apn_data=xmlHttp.responseText;
        var start1=apn_data.indexOf("http://");
        var stop1=apn_data.indexOf(";s+");
        var adurl=apn_data.substring(stop1-2,start1);
        adurl=adurl.replace("ttj?","tt?");      
        adurl=adurl+".&&view_iv=1&view_pos=750,360&view_ws=1340,360&view_vs=0&bdref=http%3A%2F%2Fwww.gulte.com%2F&bdtop=true&bdifs=0&bstk=http%3A%2F%2Fwww.gulte.com%2F&&id=8521974";
        
        
document.getElementById("app1").src=adurl;
        //location.href ="ad2.html?url=" + encodeURIComponent(adurl);
        
        //location.href =adurl;
    }
}
</script>



<body onload="getSource()"></body>

<div>
          <input type="hidden" id="url" value="http://ib.adnxs.com/ttj?id=8521974">
          
</div>
<iframe id="app1" width="728" height="90" frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="yes"></iframe>
<iframe id="gum" src="https://gum.criteo.com/sync?c=30&r=2&j=cr_handle_data_a" width="728" height="90" frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="no" allowtransparency="yes"></iframe>
